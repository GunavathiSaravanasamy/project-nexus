<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="style.css" type="text/css">
    <title>Sign up</title>
</head>
<body>
    
        <div class="heading">
            <h3> Sign up</h3>
        </div>
        <div class="divcenter"> 
        <form  class="box" action="#" method="post">
        <div class="form-group">
            <label for="fullname"> Full Name</label>
            <input type="text" name="fullname" class="form-control" id="fullname" required >
            <?php
                    if (isset($fullNameErr)) {
                        echo '<div class="text text-danger">' . $fullNameErr . '</div>';
                    }
                    ?>
        </div>
        <div class="form-group">
            <label for="email">Email</label>
            <input type="email" name="email" class="form-control" id="email" required >
            <?php
                    if (isset($emailErr)) {
                        echo '<div class=" text text-danger">' . $emailErr . '</div>';
                    }
                    ?>
        </div>
        <div class="form-group">
            <label for="dob"> Date of Birth</label>
            <input type="date" name="dob" class="form-control" id="dob" required>
            <?php
                    if (isset($dob)) {
                        echo '<div class="text text-danger">' . $dobErr . '</div>';
                    }
                    ?>
        </div>
        <div class="form-group">
        <label for="gender">Gender</label>

        <select  name="gender" id="gender" class="form-control">
        <option value="female" class="form-control">Female</option>
        <option value="male" class="form-control">Male</option>
        </select>
        
    </div>
    <div class="form-group">
        <label for="password">Password</label>
        <input type="password" name="password" class="form-control" id="password" required>
        <?php
                    if (isset($passwordErr)) {
                        echo '<div class="text text-danger">' . $passwordErr . '</div>';
                    }
        ?>
    </div>
    <div class="form-group">
        <label for="password">Confirm Password</label>
        <input type="password" name="password" class="form-control" id="password" required>
        <?php
                    if (isset($confirmPasswordErr)) {
                        echo '<div class=" text text-danger">' . $confirmPasswordErr . '</div>';
                    }
                    ?>
    </div>

        <div class="form-group ">
            <label for="mobileNumber"> Mobile number</label>
            <input type="tel" name="mobileNumber" class="form-control" id="mobileNumber" required>
            <?php
            
                    if (isset($mobileNumberErr)) {
                        echo '<div class="text text-danger">' . $mobileNumberErr . '</div>';
                    }
                    ?>
        </div>
        <div class="form-group">
            <label for="addr" > Address</label>
            <textarea  name="addr" class="form-control" id="addr" ></textarea>
        </div>
        <div>
        <button type="submit" name="Submit" > Register</button>

    <a href="login.php">Already have an account?</a></div>    
    </form>
    <?php
            
            if (isset($successMessage)) {
                echo '<div class="alert alert-success mt-3" role="alert">' . $successMessage . '</div>';
            }
            ?>
    </div>
    
</body>
</html>



<?php
$fullName = $email = $dob = $password = $confirmPassword = $mobileNumber = "";

function sanitizeInput($data) {
    $data = trim($data);
    $data = stripslashes($data);
    $data = htmlspecialchars($data);
    return $data;
}

if ($_SERVER["REQUEST_METHOD"] == "POST") {

    if (empty($_POST["fullname"])) {
        $fullNameErr = "Name is required";
    } else {
        $fullName = sanitizeInput($_POST["fullname"]);
    }

    if (empty($_POST["email"])) {
        $emailErr = "Email is required";
    } else {
        $email = sanitizeInput($_POST["email"]);
        if (!filter_var($email, FILTER_VALIDATE_EMAIL)) {
            $emailErr = "Invalid email format";
        }
    }

    if (empty($_POST["dob"])) {
        $dobErr = "Date of Birth is required";
    } else {
        $dob = sanitizeInput($_POST["dob"]);
    }

    if (empty($_POST["password"])) {
        $passwordErr = "Password is required";
    } else {
        $password = sanitizeInput($_POST["password"]);
        if (empty($_POST["confirmPassword"])) {
            $confirmPasswordErr = "Confirm Password is required";
        } else {
            $confirmPassword = sanitizeInput($_POST["confirmPassword"]);
            if ($confirmPassword !== $password) {
                $confirmPasswordErr = "Passwords do not match";
            }
        }
    }

    function validateMobileNumber($mobileNumber) {
        $cleanedNumber = preg_replace('/[^0-9]/', '', $mobileNumber);
        return (strlen($cleanedNumber) === 10);
    }

    if (empty($_POST["mobileNumber"])) {
        $mobileNumberErr = "Mobile Number is required";
    } else {
        $mobileNumber = sanitizeInput($_POST["mobileNumber"]);
        if (!validateMobileNumber($mobileNumber)) {
            $mobileNumberErr = "Invalid mobile number format";
        }
    }

    if (empty($fullNameErr) && empty($emailErr) && empty($dobErr) && empty($passwordErr) && empty($confirmPasswordErr) && empty($mobileNumberErr)) {
        $successMessage = "Form submitted successfully!";
    }
}
?>
